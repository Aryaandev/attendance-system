<!DOCTYPE html>
<html>
<head>
    <title>Employee Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/static/style.css" rel="stylesheet">
</head>

<body class="d-flex justify-content-center align-items-center min-vh-100">

<!-- üåô Dark Mode Toggle -->
<button onclick="toggleTheme()"
    class="btn btn-sm btn-outline-secondary position-fixed top-0 start-0 m-3 shadow">
    üåô
</button>

<div class="glass-card p-4 shadow-lg" style="width:360px">
    <h3 class="text-center mb-4">üë®‚Äçüíº Employee Login</h3>

    <form onsubmit="loginEmployee(event)">
        <input
            id="user_id"
            class="form-control mb-3"
            placeholder="User ID"
            required
        >

        <input
            id="password"
            type="password"
            class="form-control mb-3"
            placeholder="Password"
            required
        >

        <button class="btn btn-primary w-100">
            Login
        </button>
    </form>

    <hr class="my-3">

    <a href="/employee-register" class="btn btn-outline-light w-100 mb-2">
        üìù New Employee
    </a>

    <a href="/login" class="btn btn-outline-secondary w-100">
        üõ°Ô∏è Admin Login
    </a>
</div>

<script>
async function loginEmployee(e) {
    e.preventDefault();

    const res = await fetch("/api/auth/employee-login", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            user_id: document.getElementById("user_id").value.trim(),
            password: document.getElementById("password").value
        })
    });

    const data = await res.json();
    console.log("EMPLOYEE LOGIN RESPONSE:", data);

    if (!res.ok) {
        alert(data.error || "Login failed");
        return;
    }

    // ‚úÖ Save session
    localStorage.setItem("token", data.token);
    localStorage.setItem("role", data.role);
    localStorage.setItem("user_id", data.user_id);

    // ‚úÖ Redirect
    window.location.href = "/dashboard";
}

function toggleTheme() {
    document.body.classList.toggle("dark-mode");
    localStorage.setItem(
        "theme",
        document.body.classList.contains("dark-mode") ? "dark" : "light"
    );
}

// Apply saved theme
if (localStorage.getItem("theme") === "dark") {
    document.body.classList.add("dark-mode");
}
</script>

</body>
</html>
